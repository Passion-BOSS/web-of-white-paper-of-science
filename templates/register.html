<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>注册 - 科创白皮书</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"></head>
<body>
    <!-- 头部 -->
    <header>
        <div class="container header-content">
            <div class="logo">
                <a href="{{ url_for('index') }}">
                    <div class="logo-icon">
                        <i class="fas fa-book-open"></i>
                    </div>
                    <div class="logo-text">
                        <h1>科创白皮书</h1>
                        <p>大连理工大学创新创业竞赛指南</p>
                    </div>
                </a>
            </div>
            
            <ul class="nav-links">
                <li><a href="{{ url_for('index') }}">首页</a></li>
                <li><a href="{{ url_for('categories') }}">问题分类</a></li>
                <li><a href="{{ url_for('ask') }}">我要提问</a></li>
                {% if current_user.is_authenticated and current_user.is_admin %}
                <li><a href="{{ url_for('admin') }}">管理面板</a></li>
                {% endif %}
            </ul>
            
            <div class="auth-buttons">
                {% if current_user.is_authenticated %}
                    <span class="user-welcome">欢迎, {{ current_user.username }}</span>
                    <a href="{{ url_for('logout') }}" class="btn btn-outline">
                        <i class="fas fa-sign-out-alt"></i>退出
                    </a>
                {% else %}
                    <a href="{{ url_for('login') }}" class="btn btn-outline">
                        <i class="fas fa-sign-in-alt"></i>登录
                    </a>
                    <a href="{{ url_for('register') }}" class="btn btn-primary active">
                        <i class="fas fa-user-plus"></i>注册
                    </a>
                {% endif %}
            </div>
        </div>
    </header>
    
    <!-- 消息提示 -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="flash-messages container">
                {% for category, message in messages %}
                    <div class="flash-message flash-{{ category }}">
                        {{ message }}
                        <button class="flash-close" onclick="this.parentElement.style.display='none'">&times;</button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}
    
    <!-- 主内容区 -->
    <div class="container main-content">
        <div class="auth-container">
            <div class="auth-card">
                <h2><i class="fas fa-user-plus"></i> 用户注册</h2>
                <p>注册账号以提交问题和管理内容</p>
                
                <form id="registerForm" method="POST" action="{{ url_for('register') }}">
                    <div class="form-group">
                        <label for="username">用户名 *</label>
                        <input type="text" id="username" name="username" required placeholder="请输入用户名（3-20个字符）">
                    </div>

                    <div class="form-group">
                        <label for="email">邮箱 *</label>
                        <input type="email" id="email" name="email" required placeholder="请输入邮箱地址">
                    </div>

                    <div class="form-group">
                        <label for="password">密码 *</label>
                        <div class="password-field">
                            <input type="password" id="password" name="password" required placeholder="请输入密码（至少6个字符）">
                            <button type="button" class="toggle-password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="confirm_password">确认密码 *</label>
                        <div class="password-field">
                            <input type="password" id="confirm_password" name="confirm_password" required placeholder="请再次输入密码">
                            <button type="button" class="toggle-password">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                    </div>

                    <div class="secret-key-toggle">
                        <input type="checkbox" id="showSecretKey">
                        <label for="showSecretKey">我是管理员</label>
                    </div>

                    <div class="form-group secret-key-field" id="secretKeyField" style="display: none;">
                        <label for="secret_key">管理员秘钥</label>
                        <input type="text" id="secret_key" name="secret_key" placeholder="输入秘钥kcbps可获得管理员权限">
                        <small>普通用户请留空，仅科创白皮书内部成员需要填写</small>
                    </div>

                    <div class="form-group">
                        <button type="submit" class="btn btn-primary w-100">
                            <i class="fas fa-user-plus"></i> 注册
                        </button>
                    </div>

                    <div class="auth-link">
                        已有账号？ <a href="{{ url_for('login') }}">立即登录</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 底部 -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h5>科创白皮书</h5>
                    <p>大连理工大学创新创业竞赛一站式指南，整合高频问题与解决方案，助力学生科创之路。</p>
                </div>

                <div class="footer-section">
                    <h5>快速链接</h5>
                    <ul class="footer-links">
                        <li><a href="{{ url_for('index') }}">首页</a></li>
                        <li><a href="{{ url_for('categories') }}">问题分类</a></li>
                        <li><a href="{{ url_for('ask') }}">我要提问</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h5>主要比赛</h5>
                    <ul class="footer-links">
                        <li><a href="#">大学生创新创业训练计划</a></li>
                        <li><a href="#">"挑战杯"全国大学生系列竞赛</a></li>
                        <li><a href="#">"互联网+"大学生创新创业大赛</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h5>联系我们</h5>
                    <ul class="footer-links">
                        <li><a href="#">大连理工大学创新创业学院</a></li>
                        <li><a href="#">科创白皮书-学姐学长邮箱: kcb@dlut.edu.cn</a></li>
                        <li><a href="#">微信公众号: DUT科创白皮书</a></li>
                    </ul>
                </div>
            </div>

            <div class="copyright">
                <p>&copy; 2026 大连理工大学大工书院科创白皮书 | 设计：大工书院6人小组 | 仅供内部使用</p>
            </div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/auth.js') }}"></script>
    <script>
        // 密码可见性切换
        document.querySelectorAll('.toggle-password').forEach(button => {
            button.addEventListener('click', function() {
                const input = this.previousElementSibling;
                const icon = this.querySelector('i');
                if (input.type === 'password') {
                    input.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    input.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
        });

        // 显示/隐藏管理员密钥字段
        const showSecretKeyCheckbox = document.getElementById('showSecretKey');
        if (showSecretKeyCheckbox) {
            showSecretKeyCheckbox.addEventListener('change', function() {
                const secretKeyField = document.getElementById('secretKeyField');
                if (secretKeyField) {
                    secretKeyField.style.display = this.checked ? 'block' : 'none';
                    if (!this.checked) {
                        document.getElementById('secret_key').value = '';
                    }
                }
            });
        }
    </script>
</body>
</html>